import dns.resolver 
import sys

entrada = "a"

try:
    dominio = sys.argv[1]
    nome_arquivo = sys.argv[2]

except:
    print "Argumentos invalidos"
    print "Usage: dnsbrute.py <dominio> <wordlist>"
    sys.exit(1)

try:
    arq = open(nome_arquivo)
    subdominios = arq.read().splitlines()

except:
    print "Arquivo nao encontrado"
    sys.exit()

for subdominio in subdominios:
    try:
        dm_e_subdm = subdominio + "." + dominio
        resultados = dns.resolver.query(dm_e_subdm, entrada)

        for resultado in resultados:
            print dm_e_subdm, resultado

    except:
        pass

